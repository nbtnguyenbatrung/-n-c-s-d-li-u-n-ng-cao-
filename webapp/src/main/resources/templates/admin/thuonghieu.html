<!--A Design by W3layouts
Author: W3layout
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->

<!DOCTYPE html>
<html lang="zxx" xmlns:th="http://www.thymeleaf.org">
<head>
<title>Visitors an Admin Panel Category Bootstrap Responsive Website Template | Responsive_table :: w3layouts</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Visitors Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template, 
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<!-- bootstrap-css -->
<link rel="stylesheet" th:href="@{css/bootstrap-3.3.7-dist/css/bootstrap.css}">
<link rel="stylesheet" th:href="@{css/bootstrap.min.css}" >
<!-- //bootstrap-css -->
<!-- Custom CSS -->
<link th:href="@{css/style.css}" rel='stylesheet' type='text/css' />
<link th:href="@{css/style-responsive.css}" rel="stylesheet"/>


<!-- font CSS -->
<link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
<!-- font-awesome icons -->
<link rel="stylesheet" th:href="@{css/font.css}" type="text/css"/>
<link th:href="@{css/font-awesome.css}" rel="stylesheet">
<link rel="stylesheet" th:href="@{css/style-form.css}">

<!-- //font-awesome icons -->
<script th:src="@{js/jquery2.0.3.min.js}"></script>
<script th:src="@{js/jqueryv3.6.0.js}"></script>
<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>-->
</head>
<body>
<section id="container">
<!--header start-->
<header class="header fixed-top clearfix">
<!--logo start-->
<div class="brand">

    <a href="http://localhost:9999/admin" class="logo">
        VISITORS
    </a>
    <div class="sidebar-toggle-box">
        <div class="fa fa-bars"></div>
    </div>
</div>
<!--logo end-->

<div class="top-nav clearfix">
    <!--search & user info start-->
    <ul class="nav pull-right top-menu">

        <!-- user login dropdown start-->
        <li class="dropdown">
            <a data-toggle="dropdown" class="dropdown-toggle" >
                <img alt="" th:src="@{images/3.png}">
                <span class="username" th:utext="${username}"></span>
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu extended logout">
                <li><a th:href="@{/logout}"><i class="fa fa-key"></i> Log Out</a></li>
            </ul>
        </li>
        <!-- user login dropdown end -->
       
    </ul>
    <!--search & user info end-->
</div>
</header>
<!--header end-->
<!--sidebar start-->
<aside>
    <div id="sidebar" class="nav-collapse">
        <!-- sidebar menu start-->
        <div class="leftside-navigation">
            <ul class="sidebar-menu" id="nav-accordion">
                <li>
                    <a href="http://localhost:9999/admin">
                        <i class="fa fa-dashboard"></i>
                        <span>Tổng quan</span>
                    </a>
                </li>
                
                <li class="sub-menu">
                    <a href="javascript:;">
                        <i class="fa fa-th"></i>
                        <span>Sản phẩm</span>
                    </a>
                    <ul class="sub">
                        <li><a href="http://localhost:9999/admin/sanpham">Sản phẩm </a></li>
                        <li><a href="http://localhost:9999/admin/sanphamsize">Sản phẩm size </a></li>
                        <li><a href="http://localhost:9999/adminsanphamkhuyenmai">Sản phẩm khuyến mại </a></li>
                        <li><a href="http://localhost:9999/admin/sanphamdanhgia">Sản phẩm được đánh giá </a></li>
                    </ul>
                </li>

                <li>
                  <a class="active" href="http://localhost:9999/admin/thuonghieu">
                      <i class="fa fa-book"></i>
                      <span> thương hiệu sản phẩm </span>
                  </a>
                </li>

                <li>
                  <a href="http://localhost:9999/admin/khuyenmai">
                      <i class="fa fa-money"></i>
                      <span> Khuyến mãi </span>
                  </a>
                </li>

                <li>
                  <a href="http://localhost:9999/admin/loaisanpham">
                      <i class="fa fa-book"></i>
                      <span> Loại sản phẩm </span>
                  </a>
                </li>

                <li>
                  <a href="http://localhost:9999/adminsize">
                      <i class="fa fa-book"></i>
                      <span> Size </span>
                  </a>
                </li>

                <li>
                  <a href="http://localhost:9999/admin/nguoidung">
                      <i class="fa fa-group"></i>
                      <span> Người dùng </span>
                  </a>
                </li>
                <li class="sub-menu">
                    <a href="javascript:;">
                        <i class="fa fa-tasks"></i>
                        <span>Hóa đơn</span>
                    </a>
                    <ul class="sub">
                      <li><a href="http://localhost:9999/admin/donhang"> Đơn hàng </a></li>
                      <li><a href="http://localhost:9999/admin/hoadon">Hóa đơn </a></li>
                    </ul>
                </li>
                
                <li class="sub-menu">
                    <a href="javascript:;">
                        <i class=" fa fa-bar-chart-o"></i>
                        <span>Báo cáo</span>
                    </a>
                    <ul class="sub">
                        <li><a href="chartjs.html">Chart js</a></li>
                        <li><a href="flot_chart.html">Flot Charts</a></li>
                    </ul>
                </li>
                
            </ul>            </div>
        <!-- sidebar menu end-->
    </div>
</aside>
<!--sidebar end-->
<!--main content start-->
<section id="main-content">
	<section class="wrapper">
		<div class="table-agile-info">
      <div style="    display: flex;">
      <button title=" Thêm " style="background: transparent; border: none;" type="button" class="btn btn-primary" data-toggle="modal" data-target=".bs-example-modal-lg" >
        <i class="fa fa-plus" style="color : black "></i>
        <span style="color: black;"> Add </span>
      </button>
      <input title="search" id="search" type="text" class="form-control search" placeholder=" Search">
      </div>
    <!-- phần modal của add  -->
      <div class="modal fade bs-example-modal-lg " tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" align = center>
        <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
            <div class="modal-body">
              <div class="row" align = center >
                  <h3> Thêm sản phẩm cho web </h3>
                  <form action=""  th:object="${thuonghieu}"  method="post" >
                    <table  cellspacing=20 width="400" class="table" ui-jq="footable" ui-options='{
                      "paging": {
                        "enabled": true
                      },
                      "filtering": {
                        "enabled": true
                      },
                      "sorting": {
                        "enabled": true
                      }}'>

                      <tr>
                          <td>Mã Hãng *</td>
                          <td><input type="text" name="mahangadd" th:field="*{maHang}" id="mahangadd" required  readonly /></td>
                      </tr>

                      <tr>
                        <td>Tên Hãng *</td>
                        <td><input type="text" name="tenhangadd" th:field="*{tenHang}" id="tenhangadd" required  /></td>
                      </tr>
                      <tr>
                          <td></td>
                          <td><img id="image" src="" width="120" height="130"
                                   class="img-thumbnail" ></td>
                      </tr>  
                      <tr>
                        <td>Logo *</td>
                        <td><input type="file" th:field="*{logo}" id="fileupload" name="fileupload"
                           onchange="choosefile(this)"  accept="image/png , image/jpeg"   required    /></td>
                      </tr>
                    </table>
                  </form>
                  <button id="addthuonghieu" onclick="upload()"> Save </button>
              </div>
            </div>

          </div>
        </div>

      </div>
    <!-- phần kết thúc modal cảu add  -->
 <div class="panel panel-default">
    <div class="panel-heading">
     Bảng Thương Hiệu
    </div>
    <div>
      <table class="table" ui-jq="footable" ui-options='{
        "paging": {
          "enabled": true
        },
        "filtering": {
          "enabled": true
        },
        "sorting": {
          "enabled": true
        }}'>
        <thead>
          <tr >
            <th style="text-align:center">Mã Hãng</th>
            <th style="text-align:center">Tên Hãng</th>
            <th style="text-align:center">Logo</th>
            <th style="text-align:center">Tác Vụ </th>
          </tr>
        </thead>
        <tbody  id="load_data">

        </tbody>
      </table>

        <!-- Modal -->
        <div class="modal fade" id="ConfimationId" tabindex="-1" role="dialog" aria-labelledby="modelTitleId" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Thông Báo </h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        Bạn có muốn xóa Hãng " <span id="ThuonghieuName"></span> " ?
                    </div>
                    <div class="modal-footer">
                        <a id="yesOption" onclick="showinfomation()" type="button" class="btn btn-danger">Yes</a>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>

                    </div>
                </div>
            </div>
        </div>

        <!-- phần modol của edit  -->

        <div class="modal fade bs-example-modal-lg1 myform" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" align = center>
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="row" align = center >
                            <h3> Sửa thương hiệu </h3>
                            <form method="post">
                                <table  cellspacing=20 width="400" class="table" ui-jq="footable" ui-options='{
                                  "paging": {
                                    "enabled": true
                                  },
                                  "filtering": {
                                    "enabled": true
                                  },
                                  "sorting": {
                                    "enabled": true
                                  }}'>

                                    <tr>
                                        <td>Mã thương hiệu *</td>
                                        <td><input type="text"  id="maHang"  required readonly /></td>
                                    </tr>

                                    <tr>
                                        <td>Tên thương hiệu *</td>
                                        <td><input type="text"  id="tenHang"  required /></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td><img id="imageedit" src="" width="120" height="130"
                                                 class="img-thumbnail"></td>
                                    </tr>
                                    <tr>
                                        <td>Logo *</td>
                                        <td><input type="file" id="logo" name="logo"
                                        onchange="choosefileedit(this)"  accept="image/png , image/jpeg"  /></td>
                                    </tr>

                                </table>
                            </form>
                            <button id="editthuonghieu" onclick="upload()"> Save Edit </button>
                        </div>
                    </div>

                </div>
            </div>

        </div>

    </div>
  </div>
</div>
</section>
 <!-- footer -->
		  <div class="footer">
			<div class="wthree-copyright">
			  <p>© 2017 Visitors. All rights reserved | Design by <a href="http://w3layouts.com">W3layouts</a></p>
			</div>
		  </div>
  <!-- / footer -->
</section>

<!--main content end-->
</section>
<script th:src="@{js/bootstrap.js}"></script>
<script th:src="@{js/jquery.dcjqaccordion.2.7.js}"></script>
<script th:src="@{js/scripts.js}"></script>
<script th:src="@{js/jquery.slimscroll.js}"></script>
<script th:src="@{js/jquery.nicescroll.js}"></script>
<!--[if lte IE 8]><script language="javascript" type="text/javascript" th:src="@{js/flot-chart/excanvas.min.js}"></script><![endif]-->
<script th:src="@{js/jquery.scrollTo.js}"></script>
<script th:src="@{js/admin.js}"></script>
<!-- scrip chó thêm sửa xóa upload ảnh -->
<script>
            var page = 1;
            var action = 'inactive';
            var check = 1;
            var keyword = "" ;

			function choosefile(fileInput){
			    if(fileInput.files && fileInput.files[0]){
			        var reader = new FileReader();
			        reader.onload = function(e){
			            $('#image').attr('src',e.target.result );

			        }
			        reader.readAsDataURL(fileInput.files[0]);
			    }
			}
			function choosefileedit(fileInput){
			    if(fileInput.files && fileInput.files[0]){
			        var reader = new FileReader();
			        reader.onload = function(e){
			            $('#imageedit').attr('src',e.target.result );
			        }
			        reader.readAsDataURL(fileInput.files[0]);
			    }
			}

			async function upload(){
			    var text = $(this).text();
			    if(text == 'Save'){
			        let formData = new FormData();
                    formData.append("file" , fileupload.files[0]);
                    let response = await fetch('/upload' ,{
                        method : "POST",
                        body: formData
                    });
			    }
			    else{
			        let formData = new FormData();
                    formData.append("file" , logo.files[0]);
                    let response = await fetch('/upload' ,{
                        method : "POST",
                        body: formData
                    });
			    }
			}

			function showinfomation(){
                alert(" xóa dữ liệu thành công  ");
            }

        $(document).ready(function(){
            if(action == 'inactive'){
                action = 'active';
                LoadData(page,keyword);
            }

            $(window).scroll(function(){

                if($(window).scrollTop() + $(window).height() > $('#load_data').height() && check == 1 && action == 'inactive')
                {
                    action = 'active';
                    page = page + 1;
                    setTimeout(function(){
                        LoadData(page,keyword);
                    },1000);
                }
            });

            $('body').on('click','.Showconfim',function(){
                var name = $(this).data('name');
                var id = $(this).data('id');
                $('#ThuonghieuName').text(name);
					$('#yesOption').attr('href','/deleteth?id='+id);
					$('#ConfimationId').modal('show');
            });
        });
        function LoadData(page,keyword) {
            $.ajax({
                url: 'http://localhost:9999/admin/thuonghieuall',
                type: 'GET',
                data: {
                    page : page,
                    keyword : keyword,
                },
                success: function (rs) {
                    if(rs == ""){
                        check = 2;
                    }else{
                        var str = "";
                        $.each(rs, function (i, item) {

                            var img = './img/logo/' + item.logo;
                            var href = '/findOneth/?id=' + item.maHang;
                            str += "<tr data-expanded='true' align='center' class='trung'> " ;
                            str += "<td>" + item.maHang;
                            str += "</td>";
                            str += "<td >" + item.tenHang;
                            str += "</td>";
                            str += "<td>" ;
                            str += "<img src=" +img + " height='130' width='120' class='img-thumbnail' >";
                            str += "</td>";
                            str += "<td>";
                            str += "<a data-mahangedit = '"+item.maHang+"' class='editthuonghieu'>";
                            str += "<button title=' Sửa ' data-toggle='modal' data-target='.bs-example-modal-lg1'>";
                            str += "<i class='fa fa-wrench' style='color : black; '>";
                            str += "</i>";
                            str += "</button>";
                            str += "</a>";
                            str += "<a data-id = '"+item.maHang+"' data-name = '"+item.tenHang+"' class='Showconfim' >";
                            str += "<button title=' xóa '>";
                            str += "<i class='fa fa-times' style='color : black '>";
                            str += "</i>";
                            str += "</button>";
                            str += "</a>";
                            str += "</td>";
                            str += "</tr>";

                        });

                        // id của thẻ tbody để hiển thị tất cả cá tr ra
                        $('#load_data').append(str);
                        action = 'inactive';
                        check = 1;

                    }
                }
            });
      };

      $('#search').keypress(function(event){
          var keycode = (event.keyCode ? event.keyCode : event.which);
          if (keycode == '13') {
            keyword=$('#search').val();
            page = 1;
            [...document.getElementsByClassName("trung")].map(n => n && n.remove());
            LoadData(page,keyword);
          }
      });

</script>
</body>
</html>
